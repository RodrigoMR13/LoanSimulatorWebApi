CREATE DATABASE Simulacoes;
GO
USE Simulacoes;
GO
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
GO

BEGIN TRANSACTION;
CREATE TABLE [dbo].[SIMULACAO_EMPRESTIMO] (
    [ID] bigint NOT NULL IDENTITY,
    [CREATED_AT] datetime2 NOT NULL DEFAULT (DATEADD(HOUR, -3, GETUTCDATE())),
    [ID_PRODUTO] int NOT NULL,
    [NO_PRODUTO] varchar(200) NOT NULL,
    [TAXA_JUROS] numeric(10,9) NOT NULL,
    CONSTRAINT [PK_SIMULACAO_EMPRESTIMO] PRIMARY KEY ([ID])
);

CREATE TABLE [dbo].[SIMULACOES] (
    [ID] bigint NOT NULL IDENTITY,
    [CREATED_AT] datetime2 NOT NULL DEFAULT (DATEADD(HOUR, -3, GETUTCDATE())),
    [TIPO_AMORTIZACAO] varchar(80) NOT NULL,
    [ID_SIMULACAO_EMPRESTIMO] bigint NOT NULL,
    CONSTRAINT [PK_SIMULACOES] PRIMARY KEY ([ID]),
    CONSTRAINT [FK_SIMULACOES_SIMULACAO_EMPRESTIMO_ID_SIMULACAO_EMPRESTIMO] FOREIGN KEY ([ID_SIMULACAO_EMPRESTIMO]) REFERENCES [dbo].[SIMULACAO_EMPRESTIMO] ([ID]) ON DELETE CASCADE
);

CREATE TABLE [dbo].[PARCELAS] (
    [ID] bigint NOT NULL IDENTITY,
    [CREATED_AT] datetime2 NOT NULL DEFAULT (DATEADD(HOUR, -3, GETUTCDATE())),
    [NUM_PARCELA] smallint NOT NULL,
    [VR_AMORTIZACAO] numeric(18,2) NOT NULL,
    [VR_JUROS] numeric(18,2) NOT NULL,
    [VR_PARCELA] numeric(18,2) NOT NULL,
    [ID_SIMULACAO] bigint NOT NULL,
    CONSTRAINT [PK_PARCELAS] PRIMARY KEY ([ID]),
    CONSTRAINT [FK_PARCELAS_SIMULACOES_ID_SIMULACAO] FOREIGN KEY ([ID_SIMULACAO]) REFERENCES [dbo].[SIMULACOES] ([ID]) ON DELETE CASCADE
);

CREATE INDEX [IX_PARCELAS_ID_SIMULACAO] ON [dbo].[PARCELAS] ([ID_SIMULACAO]);

CREATE INDEX [IX_SIMULACOES_ID_SIMULACAO_EMPRESTIMO] ON [dbo].[SIMULACOES] ([ID_SIMULACAO_EMPRESTIMO]);

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250822002215_InitialMigration', N'9.0.8');

COMMIT;
GO


CREATE DATABASE Hack;
GO
USE Hack;
GO

BEGIN TRANSACTION;
CREATE TABLE dbo.PRODUTO (
	CO_PRODUTO int NOT NULL primary key,
	NO_PRODUTO varchar(200) NOT NULL,
	PC_TAXA_JUROS numeric(10, 9) NOT NULL,
	NU_MINIMO_MESES smallint NOT NULL,
	NU_MAXIMO_MESES smallint NULL,
	VR_MINIMO numeric(18, 2) NOT NULL,
	VR_MAXIMO numeric(18, 2) NULL
)
COMMIT;
GO

BEGIN TRANSACTION;
INSERT INTO dbo.PRODUTO (CO_PRODUTO, NO_PRODUTO, PC_TAXA_JUROS, NU_MINIMO_MESES, NU_MAXIMO_MESES, VR_MINIMO, VR_MAXIMO)
VALUES (1, 'Produto 1', 0.017900000, 0, 24, 200.00, 10000.00)

INSERT INTO dbo.PRODUTO (CO_PRODUTO, NO_PRODUTO, PC_TAXA_JUROS, NU_MINIMO_MESES, NU_MAXIMO_MESES, VR_MINIMO, VR_MAXIMO)
VALUES (2, 'Produto 2', 0.017500000, 25, 48, 10000.01, 100000.00)

INSERT INTO dbo.PRODUTO (CO_PRODUTO, NO_PRODUTO, PC_TAXA_JUROS, NU_MINIMO_MESES, NU_MAXIMO_MESES, VR_MINIMO, VR_MAXIMO)
VALUES (3, 'Produto 3', 0.018200000, 49, 96, 100000.01, 1000000.00)

INSERT INTO dbo.PRODUTO (CO_PRODUTO, NO_PRODUTO, PC_TAXA_JUROS, NU_MINIMO_MESES, NU_MAXIMO_MESES, VR_MINIMO, VR_MAXIMO)
VALUES (4, 'Produto 4', 0.015100000, 96, null, 1000000.01, null)
COMMIT;
GO